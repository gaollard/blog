---
title: 04-动态映射模板
url: https://www.yuque.com/gaollard/efekv4/lhry0u
---



### 1. 动态映射模板

动态映射模板使得在默认的动态字段映射规则之外能够更好地控制 Elasticsearch 如何映射数据。

用户可以通过将 `dynamic` 参数设置为 `true` 来启用动态映射模式，然后使用动态模板来定义自定义映射，这些映射可以根据匹配条件应用于动态添加的字段。



### 2. 相关参数

- match\_mapping\_type：表示对 Elasticsearch 检测到的数据类型进行操作。
- match 和 unmatch：表示使用模式匹配来匹配字段名称。

**语法**

```json
{
  "dynamic_templates": [
    {
      "my_template_name": {
        ... match conditions ...
        "mapping": { ... }
      }
    },
    ...
  ]
}
```

需要注意的是，如果动态映射模板未定义 match\_mapping\_type 或者 match 参数，则不会匹配任何字段。



### 3. 使用范例

```json
PUT myindex
{
  "mappings": {
    "dynamic_templates": [
      {
        "one": {
          "match_mapping_type": "long",
          "mapping": {
            "type": "integer"
          }
        }
      },
      {
        "two": {
          "match_mapping_type": "string",
          "mapping": {
            "type": "text",
            "fields": {
              "raw": {
                "type": "keyword",
                "ignore_above": 256
              }
            }
          }
        }
      }
    ]
  }
}
```

当添加文档的时候，如果Elasticsearch程序中的JsonParser对象解析出来的类型是match\_mapping\_type指定的类型，程序就会使用对应的mapping作为映射规则。
