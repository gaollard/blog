---
title: 01-聚合函数介绍
url: https://www.yuque.com/gaollard/efekv4/cr3cfl
---



### 分组统计每组的最大值 aggs & terms & max

```shell
GET /myindex_aggs/_search
{
  "size": 0,
  "aggs": {
    "group_by_address": {
      "terms": {
        "field": "address.keyword",
        "order": {
          "score_max": "desc"
        }
      },
      "aggs": {
        "score_max": {
          "max": {
            "field": "score"
          }
        }
      }
    }
  }
}
```

```shell
{
  "took" : 2,
…
  "hits" : {
    "total" : {
      "value" : 4,
      "relation" : "eq"
    },
    "max_score" : null,
    "hits" : [ ]
  },
  "aggregations" : {
    "group_by_address" : {
      "doc_count_error_upper_bound" : 0,
      "sum_other_doc_count" : 0,
      "buckets" : [
        {
          "key" : "上海",
          "doc_count" : 2,
          "score_max" : {
            "value" : 90.0
          }
        },
        {
          "key" : "杭州",
          "doc_count" : 2,
          "score_max" : {
            "value" : 80.0
          }
        }
      ]
    }
  }
}
```
