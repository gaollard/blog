---
title: 05-集群状态更新
url: https://www.yuque.com/gaollard/efekv4/oug7g7
---

如前两节内容所述，无论是集群中新添加节点，还是节点有异常，都需要维护集群状态。而主节点是唯一一个能够更新集群状态的节点。

一个时间段内主节点只能更新一个集群状态，并且将更改的集群状态发送给其他节点，当其他节点接收到状态时，先确认收到消息，但是此时并不更新到最新状态。如果主节点在规定时间（discovery.zen.commit\_timeout默认30秒）内没有收到大多数节点（大多数节点数量=discovery.zen.minimum\_master\_nodes参数的值）的确认，那么集群状态更新请求不会被通过。

一旦足够的节点响应了更新的消息，新的集群状态才会被提交，并且会发送一条消息给所有的节点。随后这些节点开始在内部更新至新的集群状态，如图10-6所示。

![](https://s3.airtlab.com/elasticsearch/20220430213309.png)

当集群状态有了新的变化，都是主节点主动通知其他节点来同步集群状态的信息。
