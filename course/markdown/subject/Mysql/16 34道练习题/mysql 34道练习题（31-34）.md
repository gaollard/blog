---
title: mysql 34道练习题（31-34）
---

### 31. 列出所有员工的年工资，按年薪从低到高排序

```sql
select sal * 12 as year_sal from emp e order by year_sal DESC;

+----------+
| year_sal |
+----------+
| 60000.00 |
| 36000.00 |
| 36000.00 |
| 35700.00 |
| 34200.00 |
| 29400.00 |
| 19200.00 |
| 18000.00 |
| 15600.00 |
| 15000.00 |
| 15000.00 |
| 13200.00 |
| 11400.00 |
|  9600.00 |
+----------+
```

### 32. 求出员工领导的薪水超过3000的员工名称和领导名称

```sql
select
	e.`ename`,
	a.ename as boss,
	a.sal
	
from emp e join emp a on e.`mgr` = a.`empno` where a.sal>3000;

+-------+------+---------+
| ename | boss | sal     |
+-------+------+---------+
| JONES | KING | 5000.00 |
| BLAKE | KING | 5000.00 |
| CLARK | KING | 5000.00 |
+-------+------+---------+
```

### 33. 求部门名称中带“S”字符的部门员工的工资合计&部门人数

```sql
-- 部门名称中带“S”字符的部门A
-- 求A中，每一个部门员工的工资合计 以及 部门人数

select
	d.deptno,
	d.dname,
	sum(e.`sal`) as sum_sal,
	count(e.`empno`) as count_emp
from
	dept d
join
	emp e
on
	e.`deptno` = d.`deptno`
where
	d.dname like '%s%'
group by
	d.dname;
  
+--------+----------+----------+-----------+
| deptno | dname    | sum_sal  | count_emp |
+--------+----------+----------+-----------+
|     20 | RESEARCH | 13325.00 |         6 |
|     30 | SALES    |  9400.00 |         6 |
+--------+----------+----------+-----------+
```

### 34. 给任职日期超过30年的员工加薪10%

```sql
-- 找出职日期超过30年的员工

-- # 先备份一下表
create table emp_bak as select * from emp;
update emp_bak set sal = sal *1.1 where (to_days(now())-to_days(hiredate))/365>30;
-- +-------+--------+-----------+------+------------+---------+---------+--------+
-- | EMPNO | ENAME  | JOB       | MGR  | HIREDATE   | SAL     | COMM    | DEPTNO |
-- +-------+--------+-----------+------+------------+---------+---------+--------+
-- |  7396 | SMITH  | CLERK     | 7902 | 1980-12-17 |  880.00 |    NULL |     20 |
-- |  7499 | ALLEN  | SALESMAN  | 7698 | 1981-02-20 | 1760.00 |  300.00 |     30 |
-- |  7521 | WARD   | SALESMAN  | 7698 | 1981-02-22 | 1375.00 |  500.00 |     30 |
-- |  7566 | JONES  | MANAGER   | 7839 | 1981-04-02 | 3272.50 |    NULL |     20 |
-- |  7654 | MARTIN | SALESMAN  | 7698 | 1981-09-28 | 1375.00 | 1400.00 |     30 |
-- |  7698 | BLAKE  | MANAGER   | 7839 | 1981-05-01 | 3135.00 |    NULL |     30 |
-- |  7782 | CLARK  | MANAGER   | 7839 | 1981-06-09 | 2695.00 |    NULL |     20 |
-- |  7788 | SCOTT  | ANALYST   | 7566 | 1987-04-19 | 3300.00 |    NULL |     20 |
-- |  7839 | KING   | PRESIDENT | NULL | 1981-11-17 | 5500.00 |    NULL |     10 |
-- |  7844 | TURNER | SALESMAN  | 7698 | 1981-09-08 | 1650.00 |    0.00 |     30 |
-- |  7876 | ADAMS  | CLERK     | 7788 | 1987-05-23 | 1210.00 |    NULL |     20 |
-- |  7900 | JAMES  | CLERK     | 7698 | 1981-12-03 | 1045.00 |    NULL |     30 |
-- |  7902 | FORD   | ANALYST   | 7566 | 1981-12-03 | 3300.00 |    NULL |     20 |
-- |  7934 | MILLER | CLERK     | 7782 | 1982-01-23 | 1430.00 |    NULL |     10 |
-- +-------+--------+-----------+------+------------+---------+---------+--------+
```
