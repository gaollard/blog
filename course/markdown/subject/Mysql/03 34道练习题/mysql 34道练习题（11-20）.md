---
title: mysql 34道练习题（11-20）
---

### 11. 取得最后入职的五名员工

```sql
# 按照入职时间来排序  入职晚 时间大
select * from emp order by HIREDATE DESC limit 0, 5
```

![image.png](http://s3.airtlab.com/mysql/1620804750369-0ac485e1-7303-455e-bf0c-d83035dacef9.png) 

### 12. 取得每个薪水等级有多少个员工

```sql
-- # 先查出每个员工的薪水等级

/* select
        e.ename,
        e.sal,
        s.grade
from
        emp  e
join
		salgrade s
on
		e.sal between s.losal and s.hisal */
		
-- +--------+---------+-------+
-- | ename  | sal     | grade |
-- +--------+---------+-------+
-- | SMITH  |  800.00 |     1 |
-- | ALLEN  | 1600.00 |     3 |
-- | WARD   | 1250.00 |     2 |
-- | JONES  | 2975.00 |     4 |
-- | MARTIN | 1250.00 |     2 |
-- | BLAKE  | 2850.00 |     4 |
-- | CLARK  | 2450.00 |     4 |
-- | SCOTT  | 3000.00 |     4 |
-- | KING   | 5000.00 |     5 |
-- | TURNER | 1500.00 |     3 |
-- | ADAMS  | 1100.00 |     1 |
-- | JAMES  |  950.00 |     1 |
-- | FORD   | 3000.00 |     4 |
-- | MILLER | 1300.00 |     2 |
		
-- # 再用聚合函数根据薪水等级分类即可

select
		t.grade,
		count(t.grade) as grade_count
from
		(
		select
		        e.ename,
        		e.sal,
		        s.grade
		from
        		emp  e
		join
				salgrade s
		on
				e.sal between s.losal and s.hisal
		) t
		
group by
		grade

-- +-------+-------------+
-- | grade | grade_count |
-- +-------+-------------+
-- |     1 |           3 |
-- |     2 |           3 |
-- |     3 |           2 |
-- |     4 |           5 |
-- |     5 |           1 |
-- +-------+-------------+
```

### 13. XXXXXXXX

### 14. 列出所有员工及领导的名字

```sql
select
		t1.ename,
		t2.ename as boss_name
from
		emp t1
join
		emp t2
on
		t1.MGR = t2.EMPNO
		
-- +--------+-------+
-- | ename  | boss  |
-- +--------+-------+
-- | SMITH  | FORD  |
-- | ALLEN  | BLAKE |
-- | WARD   | BLAKE |
-- | JONES  | KING  |
-- | MARTIN | BLAKE |
-- | BLAKE  | KING  |
-- | CLARK  | KING  |
-- | SCOTT  | JONES |
-- | KING   | NULL  |
-- | TURNER | BLAKE |
-- | ADAMS  | SCOTT |
-- | JAMES  | BLAKE |
-- | FORD   | JONES |
-- | MILLER | CLARK |
-- +--------+-------+
```

### 15. 列出受雇日期早于其直接上级的所有员工 编号&姓名&部门名称

```sql
select
		t1.empno,
		t1.ename,
		d.dname,
		t2.ename as boss_name
from
		emp t1
join
		emp t2
join
		dept d
on
		t1.deptno = d.deptno
where
		t1.MGR = t2.EMPNO and t1.`HIREDATE` < t2.`HIREDATE`
		
		
-- +--------+-------+
-- | ename  | boss  |
-- +--------+-------+
-- | SMITH  | FORD  |
-- | ALLEN  | BLAKE |
-- | WARD   | BLAKE |
-- | JONES  | KING  |
-- | MARTIN | BLAKE |
-- | BLAKE  | KING  |
-- | CLARK  | KING  |
-- | SCOTT  | JONES |
-- | KING   | NULL  |
-- | TURNER | BLAKE |
-- | ADAMS  | SCOTT |
-- | JAMES  | BLAKE |
-- | FORD   | JONES |
-- | MILLER | CLARK |
-- +--------+-------+
```

### 16. 列出部门名称和这些部门的员工信息，同时列出那些没有员工的部门

```sql
# select d.dname, e.* from dept d join emp e on d.deptno = e.deptno
select d.dname, e.* from emp e join dept d on d.deptno = e.deptno
```

![image.png](http://s3.airtlab.com/mysql/1620806857777-0d3198fc-3863-4090-92f4-76cd884278d3.png)

### 17. 列出至少有5个员工的所有部门

```sql
select
		e.deptno,
		d.dname,
		count(e.deptno) as em_count
from
		emp e
join
		dept d
on
		d.deptno = e.deptno
group by
		e.deptno
having
		em_count > 5
```

![image.png](http://s3.airtlab.com/mysql/1620807257224-06be3670-af5f-4fe5-a2e7-ee25307a8e60.png) 

### 18. 列出薪水比“SMITH”多的所有员工信息

```sql
(主要考察子查询)
select * from emp where sal>(select sal from emp where ename ='smith');
```

![image.png](http://s3.airtlab.com/mysql/1620807432665-e4f1b2a6-b535-40b8-b60a-98827df9eaf5.png) 

### 19. 列出所有“CLARK”（办事员）的姓名及其部门名 称，部门人数

```sql
-- 所有办事员(部门名称也找出)
(select e.ENAME, e.DEPTNO, e.`empno`, d.`dname` from emp e join dept d on d.`DEPTNO` = e.`DEPTNO` where e.`JOB` = "CLERK");

+--------+--------+-------+------------+
| ENAME  | DEPTNO | empno | dname      |
+--------+--------+-------+------------+
| MILLER |     10 |  7934 | ACCOUNTING |
| SMITH  |     20 |  7396 | RESEARCH   |
| ADAMS  |     20 |  7876 | RESEARCH   |
| JAMES  |     30 |  7900 | SALES      |
+--------+--------+-------+------------+
```

```sql
-- 通过 name 分组
select
		t.*,
		count(e.`EMPNO`) as emp_count
from
		(select e.ENAME as name, e.DEPTNO, e.`empno`, d.`dname` from emp e join dept d on d.`DEPTNO` = e.`DEPTNO` where e.`JOB` = "CLERK") t
join
		emp e
on
		e.`DEPTNO` = t.`DEPTNO`
group by
		t.`name` 

+--------+--------+-------+------------+-----------+
| name   | DEPTNO | empno | dname      | emp_count |
+--------+--------+-------+------------+-----------+
| ADAMS  |     20 |  7876 | RESEARCH   |         6 |
| JAMES  |     30 |  7900 | SALES      |         6 |
| MILLER |     10 |  7934 | ACCOUNTING |         2 |
| SMITH  |     20 |  7396 | RESEARCH   |         6 |
+--------+--------+-------+------------+-----------+
```

### 20. 列出最低薪水大于1500的各种工作及从事此工作的全部雇员人数

```sql
-- 查询员工表，根据工作分组，并且获取该工作的最低薪水 和 人数
select
		e.job,
    	count(e.empno) as emp_count,
		min(e.sal) as minsal
from 
		emp e
group by
		e.`job`
having
		minsal > 1500

+-----------+-----------+---------+
| job       | emp_count | minsal  |
+-----------+-----------+---------+
| ANALYST   |         2 | 3000.00 |
| MANAGER   |         3 | 2450.00 |
| PRESIDENT |         1 | 5000.00 |
+-----------+-----------+---------+
```
